# Provides the WPE Compositor plugin & client settings

# Additional flags
WPE_COMPOSITOR_AUTOSTART ??= "true"
WPE_COMPOSITOR_OUTOFPROCESS ??= "true"
WPE_COMPOSITOR_RESOLUTION ??= "720p"

# Additional flags for Wayland implementations
WPE_COMPOSITOR_VIRTUALINPUT ??= "ON"
WPE_COMPOSITOR_CURSOR_FILE ??= ""

# Choose westeros or weston dependency
WPE_COMPOSITOR_WAYLAND_SUB_IMPL ??= "Westeros"
WPE_COMPOSITOR_WAYLAND_DEP ??= "westeros"

# Repo details
WPE_COMPOSITOR_WAYLAND_IMPLEMENTATION_PATH ??= ""
WPE_COMPOSITOR_WAYLAND_IMPLEMENTATION_REPOSITORY ??= "https://code.rdkcentral.com/r/soc/broadcom/components/rdkcentral/thundernanoservices/Compositor"
WPE_COMPOSITOR_WAYLAND_IMPLEMENTATION_VERSION ??= "master"

PACKAGECONFIG[compositor] = "\
    -DPLUGIN_COMPOSITOR=ON \
    -DPLUGIN_COMPOSITOR_AUTOSTART=${WPE_COMPOSITOR_AUTOSTART} \
    -DPLUGIN_COMPOSITOR_OUTOFPROCESS=${WPE_COMPOSITOR_OUTOFPROCESS} \
    -DPLUGIN_COMPOSITOR_RESOLUTION=${WPE_COMPOSITOR_RESOLUTION} \
    ,-DPLUGIN_COMPOSITOR=OFF,wpeframework-clientlibraries \
"

PACKAGECONFIG[compositor_wayland] = "\
    -DPLUGIN_COMPOSITOR_IMPLEMENTATION='Wayland' \
    -DCOMPOSITOR_WAYLAND_IMPLEMENTATION_PATH=${WPE_COMPOSITOR_WAYLAND_IMPLEMENTATION_PATH} \
    -DCOMPOSITOR_WAYLAND_IMPLEMENTATION_REPOSITORY=${WPE_COMPOSITOR_WAYLAND_IMPLEMENTATION_REPOSITORY} \
    -DCOMPOSITOR_WAYLAND_IMPLEMENTATION_VERSION=${WPE_COMPOSITOR_WAYLAND_IMPLEMENTATION_VERSION} \
    -DPLUGIN_COMPOSITOR_SUB_IMPLEMENTATION=${WPE_COMPOSITOR_WAYLAND_SUB_IMPL} \
    -DPLUGIN_COMPOSITOR_CURSOR_FILE=${WPE_COMPOSITOR_CURSOR_FILE} \
    -DPLUGIN_COMPOSITOR_VIRTUALINPUT=${WPE_COMPOSITOR_VIRTUALINPUT} \
    ,,${WPE_COMPOSITOR_WAYLAND_DEP} \
"

PACKAGECONFIG[compositorclient] = "-DCOMPOSITORCLIENT=ON,-DCOMPOSITORCLIENT=OFF"
PACKAGECONFIG[compositorclient_wayland] = "\
    -DPLUGIN_COMPOSITOR_IMPLEMENTATION='Wayland' \
    -DPLUGIN_COMPOSITOR_SUB_IMPLEMENTATION=${WPE_COMPOSITOR_WAYLAND_SUB_IMPL} \
    ,,${WPE_COMPOSITOR_WAYLAND_DEP} \
"

PACKAGECONFIG[vc4graphics] = "-DVC6=ON,,libdrm mesa"

